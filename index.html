<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Cato Dogs Journal</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net"/>
<style>
:root{--bg:#f8fafc;--card:#ffffff;--ink:#0f172a;--brand:#2563eb}
*{box-sizing:border-box}body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,Segoe UI,Roboto,Arial}
.container{max-width:1100px;margin:24px auto;padding:0 16px}
h1{font-size:clamp(28px,4vw,40px);margin:0 0 16px}
.nav{display:flex;gap:12px;flex-wrap:wrap;margin:16px 0 24px}
.nav a{padding:10px 14px;border-radius:12px;background:#fff;border:1px solid #e5e7eb;text-decoration:none;color:var(--ink)}
.nav a.active{background:var(--brand);border-color:var(--brand);color:#fff}
.card{background:var(--card);border:1px solid #e5e7eb;border-radius:16px;padding:16px}
.portraits{display:flex;gap:16px;margin-bottom:12px}
.portraits img{width:96px;height:96px;border-radius:12px;object-fit:cover;border:2px solid #e5e7eb;background:#fff}
.chips{display:flex;gap:10px;flex-wrap:wrap;margin:12px 0}
.chip{padding:10px 14px;border-radius:999px;border:1px solid #cbd5e1;background:#fff;color:var(--ink);cursor:pointer}
.chip.active{background:var(--brand);border-color:var(--brand);color:#fff}
.controls{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin:12px 0}
button.primary{background:var(--brand);color:#fff;border:none;border-radius:10px;padding:12px 16px;font-weight:600}
button.ghost{background:#fff;border:1px solid #e5e7eb;border-radius:10px;padding:10px 14px}
.table{width:100%;border-collapse:collapse}
.table th,.table td{border-bottom:1px solid #e5e7eb;padding:8px;text-align:left;font-size:14px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px}
.notice{padding:10px 12px;background:#f1f5f9;border:1px solid #e5e7eb;border-radius:10px}
canvas{max-width:100%;height:340px}
@media(max-width:600px){canvas{height:260px}}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head><body><div class="container">
<h1>Cato Dogs Journal</h1>
<div class="portraits">
  <figure><img id="thorImg" alt="Thor"><figcaption>Thor</figcaption></figure>
  <figure><img id="miaImg" alt="Mia"><figcaption>Mia</figcaption></figure>
</div>
<nav class="nav" id="tabs">
  <a href="#overview" class="active">Overview</a>
  <a href="#wl">Weights & Lengths</a>
  <a href="#care">Care Plan</a>
  <a href="#birth">Birth Log</a>
  <a href="#bios">Bios</a>
  <a href="#vet">Vet & Worming</a>
  <a href="#photos">Photos</a>
</nav>
<section id="overview" class="card">
  <h2>Overview</h2><div class="notice" id="ovText"></div>
</section>
<section id="wl" class="card" hidden>
  <h2>Weights & Lengths</h2>
  <div class="chips" id="pupChips"></div>
  <div class="controls">
    <input id="dayInput" class="ghost" placeholder="Day (e.g., 21)">
    <div><input id="wInput" class="ghost" placeholder="Weight (g)"><input id="lInput" class="ghost" placeholder="Length (cm)" style="margin-left:8px"></div>
  </div>
  <div style="display:flex;justify-content:space-between;gap:8px"><button class="primary" id="saveBtn">Save</button>
    <div><button class="ghost" id="dlW">Download weights.json</button><button class="ghost" id="dlL" style="margin-left:8px">Download lengths.json</button></div>
  </div>
  <div style="margin-top:12px"><canvas id="wChart"></canvas></div>
  <h3>Weights (table)</h3><table class="table" id="wTable"></table>
</section>
<section id="care" class="card" hidden><h2>Care Plan</h2>
  <div class="grid" id="careGrid"></div>
</section>
<section id="birth" class="card" hidden><h2>Birth Log</h2><table class="table" id="birthTable"></table></section>
<section id="bios" class="card" hidden><h2>Pup Bios</h2><div class="grid" id="bioGrid"></div></section>
<section id="vet" class="card" hidden><h2>Vet & Worming</h2><div id="vetWrap"></div></section>
<section id="photos" class="card" hidden><h2>Photos</h2><div class="notice">Add photos to <b>/photos</b> and set filenames in <b>/data/pups.json</b> or <b>/data/dogs.json</b>.</div></section>
</div>
<script>
const DATA={overview:'data/overview.json',dogs:'data/dogs.json',pups:'data/pups.json',weights:'data/weights.json',lengths:'data/lengths.json',birth:'data/birth_log.json',vet:'data/vet_worming.json'};
const state={dogs:[],pups:[],weights:{},lengths:{},activePup:'pup2',chart:null};
function setActiveTab(hash){document.querySelectorAll('.nav a').forEach(a=>a.classList.toggle('active',a.getAttribute('href')===hash));document.querySelectorAll('section').forEach(s=>s.hidden=true);document.getElementById((hash||'#overview').slice(1)).hidden=false;history.replaceState(null,'',hash);}
document.getElementById('tabs').addEventListener('click',e=>{if(e.target.tagName==='A'){e.preventDefault();setActiveTab(e.target.getAttribute('href'));}});
async function loadJSON(u){const r=await fetch(u);return await r.json();}
function fmtAge(d){const t=new Date(d),n=new Date();const days=Math.floor((n-t)/86400000),w=Math.floor(days/7),r=days%7;return `${w}w ${r}d`;}
function download(name,content){const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([content],{type:'application/json'}));a.download=name;a.click();}
async function init(){
  const [overview,dogs,pups,weights,lengths,birth,vet]=await Promise.all([loadJSON(DATA.overview),loadJSON(DATA.dogs),loadJSON(DATA.pups),loadJSON(DATA.weights),loadJSON(DATA.lengths),loadJSON(DATA.birth),loadJSON(DATA.vet)]);
  state.dogs=dogs;state.pups=pups;state.weights=weights;state.lengths=lengths;
  document.getElementById('thorImg').src='photos/'+dogs.find(d=>d.id==='thor').photo;
  document.getElementById('miaImg').src='photos/'+dogs.find(d=>d.id==='mia').photo;
  document.getElementById('ovText').innerHTML=`<div><b>Summary:</b> ${overview.summary}</div><div><b>Notes:</b> ${overview.notes}</div>`;
  const bT=document.getElementById('birthTable');bT.innerHTML='<tr><th>Time</th><th>Event</th></tr>'+birth.map(x=>`<tr><td>${x.time}</td><td>${x.event}</td></tr>`).join('');
  const chips=document.getElementById('pupChips');const colors={pup2:'#2563eb',pup3:'#ef4444',pup5:'#f59e0b'};
  chips.innerHTML=pups.map(p=>`<button class="chip" data-id="${p.id}" style="border-color:${colors[p.id]}">${p.name} • ${p.collarColor} ${p.sex==='Male'?'♂':'♀'}</button>`).join('');
  chips.addEventListener('click',e=>{const b=e.target.closest('.chip');if(!b)return;state.activePup=b.dataset.id;updateChips();drawChart();fillTable();});
  function updateChips(){chips.querySelectorAll('.chip').forEach(c=>c.classList.toggle('active',c.dataset.id===state.activePup));} updateChips();
  function daysAll(){return[...new Set([].concat(...Object.values(state.weights).map(a=>a.map(x=>x[0]))))].sort((a,b)=>a-b);}
  function fillTable(){const days=daysAll();const head='<tr><th>Day</th>'+pups.map(p=>`<th>${p.name} (${p.collarColor})</th>`).join('')+'</tr>';const rows=days.map(d=>{const cols=pups.map(p=>{const hit=(state.weights[p.id]||[]).find(x=>x[0]===d);return `<td>${hit?hit[1]:''}</td>`}).join('');return `<tr><td>${d}</td>${cols}</tr>`}).join('');document.getElementById('wTable').innerHTML=head+rows;}
  function drawChart(){const ctx=document.getElementById('wChart');const cfg={type:'line',data:{datasets:[{label:'Pup 2 (Blue ♂)',data:(state.weights.pup2||[]).map(([x,y])=>({x,y})),borderColor:'#2563eb',backgroundColor:'#2563eb',tension:.25},{label:'Pup 3 (Pink ♀)',data:(state.weights.pup3||[]).map(([x,y])=>({x,y})),borderColor:'#ef4444',backgroundColor:'#ef4444',tension:.25},{label:'Pup 5 (Orange ♂)',data:(state.weights.pup5||[]).map(([x,y])=>({x,y})),borderColor:'#f59e0b',backgroundColor:'#f59e0b',tension:.25}]},options:{parsing:false,scales:{x:{type:'linear',title:{text:'Day',display:true}},y:{title:{text:'Weight (g)',display:true}}},plugins:{legend:{position:'bottom'}}}}; if(state.chart){state.chart.destroy()} state.chart=new Chart(ctx,cfg);}
  const dayI=document.getElementById('dayInput'),wI=document.getElementById('wInput'),lI=document.getElementById('lInput');
  document.getElementById('saveBtn').onclick=()=>{const d=parseInt(dayI.value,10),w=parseInt(wI.value,10),l=parseInt(lI.value,10);if(!Number.isFinite(d))return alert('Enter day');if(Number.isFinite(w)){state.weights[state.activePup]=(state.weights[state.activePup]||[]).filter(x=>x[0]!==d).concat([[d,w]]).sort((a,b)=>a[0]-b[0]);}if(Number.isFinite(l)){state.lengths[state.activePup]=(state.lengths[state.activePup]||[]).filter(x=>x[0]!==d).concat([[d,l]]).sort((a,b)=>a[0]-b[0]);}localStorage.setItem('weights',JSON.stringify(state.weights));localStorage.setItem('lengths',JSON.stringify(state.lengths));drawChart();fillTable();};
  try{const wL=localStorage.getItem('weights'),lL=localStorage.getItem('lengths');if(wL)state.weights=JSON.parse(wL);if(lL)state.lengths=JSON.parse(lL);}catch{}
  document.getElementById('dlW').onclick=()=>download('weights.json',JSON.stringify(state.weights,null,2));
  document.getElementById('dlL').onclick=()=>download('lengths.json',JSON.stringify(state.lengths,null,2));
  const bio=document.getElementById('bioGrid');function latest(pid){const a=(state.weights[pid]||[]);if(!a.length)return'';const [d,w]=a[a.length-1];return `${w} g on day ${d}`;}
  bio.innerHTML=pups.map(p=>`<div class="card"><div style="display:flex;gap:10px"><img src="photos/${p.photo}" style="width:88px;height:88px;border-radius:10px;border:1px solid #e5e7eb;object-fit:cover"><div><div><b>${p.name}</b> • <span style="font-size:12px;background:#eef;padding:2px 8px;border-radius:999px">${p.collarColor}</span></div><div style="color:#475569;font-size:14px">Sex: <b>${p.sex}</b> • DOB: <b>${p.dob}</b> • Age: <b>${fmtAge(p.dob)}</b></div><div style="color:#475569;font-size:14px">Latest weight: <b>${latest(p.id)}</b></div></div></div><p style="color:#475569;font-size:14px">Notes: <b>${p.notes||''}</b></p><button class="ghost" onclick="location.hash='#wl';setTimeout(()=>{document.querySelector('#pupChips .chip[data-id=${JSON.stringify(p.id)}]').click()},50)">View growth</button></div>`).join('');
  const vw=document.getElementById('vetWrap');function rowify(list,label){return `<table class="table"><tr><th>Date</th><th>Animal</th><th>Type</th><th>Product</th><th>Status</th></tr>`+list.map(x=>`<tr><td>${x.date}</td><td>${label(x)}</td><td>${x.type}</td><td>${x.product}</td><td>${x.status||'—'}</td></tr>`).join('')+`</table>`;} vw.innerHTML=`<h3>Parents</h3>${rowify(vet.parents,x=>x.dogId==='mia'?'Mia':'Thor')}<h3>Pups</h3>${rowify(vet.pups,x=>(pups.find(p=>p.id===x.pupId)||{}).name||x.pupId)}<div class="notice">Edit <b>/data/vet_worming.json</b> to add records, or build a form later.</div>`;
  drawChart();fillTable();setActiveTab(location.hash||'#overview');
}
init();
</script></body></html>